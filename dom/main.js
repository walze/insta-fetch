!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";var r,o="object"==typeof Reflect?Reflect:null,i=o&&"function"==typeof o.apply?o.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function u(){u.init.call(this)}e.exports=u,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var c=10;function f(e){return void 0===e._maxListeners?u.defaultMaxListeners:e._maxListeners}function a(e,t,n,r){var o,i,s,u;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]),void 0===s)s=i[t]=n,++e._eventsCount;else if("function"==typeof s?s=i[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=f(e))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,u=c,console&&console.warn&&console.warn(u)}return e}function l(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,i(this.listener,this.target,e))}.bind(r);return o.listener=n,r.wrapFn=o,o}function p(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):d(o,o.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function d(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),u.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},u.prototype.getMaxListeners=function(){return f(this)},u.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else{var f=c.length,a=d(c,f);for(n=0;n<f;++n)i(a[n],this,t)}return!0},u.prototype.addListener=function(e,t){return a(this,e,t,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(e,t){return a(this,e,t,!0)},u.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,l(this,e,t)),this},u.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,l(this,e,t)),this},u.prototype.removeListener=function(e,t){var n,r,o,i,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},u.prototype.listeners=function(e){return p(this,e,!0)},u.prototype.rawListeners=function(e){return p(this,e,!1)},u.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},u.prototype.listenerCount=h,u.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){(function(t){e.exports=t.env.PROMISE_QUEUE_COVERAGE?n(3):n(4)}).call(this,n(2))},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,f=[],a=!1,l=-1;function p(){a&&c&&(a=!1,c.length?f=c.concat(f):l=-1,f.length&&h())}function h(){if(!a){var e=u(p);a=!0;for(var t=f.length;t;){for(c=f,f=[];++l<t;)c&&c[l].run();l=-1,t=f.length}c=null,a=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new d(e,t)),1!==f.length||a||u(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){},function(e,t,n){var r,o;!function(i,s){"use strict";e.exports?e.exports=s():void 0===(o="function"==typeof(r=s)?r.call(t,n,t,e):r)||(e.exports=o)}(0,function(){"use strict";var e="undefined"!=typeof Promise?Promise:function(){return{then:function(){throw new Error("Queue.configure() before use Queue")}}},t=function(){};function n(e,t,n){this.options=n=n||{},this.pendingPromises=0,this.maxPendingPromises=void 0!==e?e:1/0,this.maxQueuedPromises=void 0!==t?t:1/0,this.queue=[]}return n.configure=function(t){e=t},n.prototype.add=function(n){var r=this;return new e(function(e,o,i){r.queue.length>=r.maxQueuedPromises?o(new Error("Queue limit reached")):(r.queue.push({promiseGenerator:n,resolve:e,reject:o,notify:i||t}),r._dequeue())})},n.prototype.getPendingLength=function(){return this.pendingPromises},n.prototype.getQueueLength=function(){return this.queue.length},n.prototype._dequeue=function(){var t=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var n,r=this.queue.shift();if(!r)return this.options.onEmpty&&this.options.onEmpty(),!1;try{this.pendingPromises++,(n=r.promiseGenerator(),n&&"function"==typeof n.then?n:new e(function(e){e(n)})).then(function(e){t.pendingPromises--,r.resolve(e),t._dequeue()},function(e){t.pendingPromises--,r.reject(e),t._dequeue()},function(e){r.notify(e)})}catch(e){t.pendingPromises--,r.reject(e),t._dequeue()}return!0},n})},function(e,t,n){"use strict";n.r(t);const r=new(n(0).EventEmitter),{ADDED_LINKS:o="added_links",LISTENING_LINKS:i="listening_links"}={},s=()=>[...document.body.querySelectorAll("[href]")].map(e=>e.href).filter(e=>/https:\/\/www\.instagram\.com\/p\//.test(e)),u=s(),c=document.createElement("div");document.body.append(c),r.on(i,()=>{r.emit(o,u,u),document.body.addEventListener("DOMSubtreeModified",()=>{let e=!1,t=0;const n=s().filter(e=>!u.includes(e)).map(n=>(t++,e=!0,n));n.length<1||(u.push(...n),r.emit(o,n,u),e&&console.log(`added ${t} links, total:`,u.length))})});const f=e=>e.map(e=>{const{content:t}=e;return{name:e.getAttribute("property"),content:t}}).filter(e=>e.name&&e.name.match(/og:.+/)).map(e=>{let t=e.name.replace("og:","");const n=e.content.match(/@([^\s)]+)/);if("description"===t&&(e.content=n[1]),"image"===t||"description"===t)return e.content}).filter(e=>!!e),a=async e=>{const t=document.createElement("div");t.innerHTML=e;const[n,r]=f([...t.querySelectorAll("meta")]);return console.info(`Got photo from @${r}`),{user:r,photo:n}};var l=n(1),p=n.n(l);const h=Number(prompt("Concurrent"))||2,d=new p.a(h,1/0);n.d(t,"fetchIFrameData",function(){return m}),n.d(t,"fetchLinkData",function(){return v});const m=e=>()=>(async e=>{const t=await e.add(),[n,r]=f([...t.contentWindow.document.querySelectorAll("meta")]);console.info(`Got photo from @${r}`);const o={user:r,photo:n};return e.remove(),o})((e=>{const t=document.createElement("iframe");t.src=e,t.style.display="none";const n=new Promise(e=>t.onload=(()=>e(t)));return{el:t,add:()=>(c.append(t),n),remove:()=>t.remove()}})(e)),v=e=>()=>fetch(e).then(e=>e.text()).then(a),y=e=>{return d.add(e)},g=[];r.on(o,(e=>async t=>t.map(v).map(y).map(async t=>(e.push(await t),t)))(g)),r.emit(i),console.log(d),console.log("\nCTRL + Z to download"),document.onkeydown=(e=>t=>{const n=window.event?event:t;90==n.keyCode&&n.ctrlKey&&e.map((e,t)=>((e,t)=>{const n="data:text/jsoncharset=utf-8,"+encodeURIComponent(JSON.stringify(e)),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",t+".json"),document.body.appendChild(r),r.click(),r.remove()})(e,`links_${t}`))})([g])}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3Byb21pc2UtcXVldWUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcHJvbWlzZS1xdWV1ZS9saWIvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V2ZW50cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYnJvd3Nlci9ET00uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Jyb3dzZXIvcXVldWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Jyb3dzZXIvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2hlbHBlcnMuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJSZWZsZWN0T3duS2V5cyIsIlIiLCJSZWZsZWN0IiwiUmVmbGVjdEFwcGx5IiwiYXBwbHkiLCJ0YXJnZXQiLCJyZWNlaXZlciIsImFyZ3MiLCJGdW5jdGlvbiIsIm93bktleXMiLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiY29uY2F0IiwiTnVtYmVySXNOYU4iLCJOdW1iZXIiLCJpc05hTiIsIkV2ZW50RW1pdHRlciIsImluaXQiLCJ0aGlzIiwiX2V2ZW50cyIsInVuZGVmaW5lZCIsIl9ldmVudHNDb3VudCIsIl9tYXhMaXN0ZW5lcnMiLCJkZWZhdWx0TWF4TGlzdGVuZXJzIiwiJGdldE1heExpc3RlbmVycyIsInRoYXQiLCJfYWRkTGlzdGVuZXIiLCJ0eXBlIiwibGlzdGVuZXIiLCJwcmVwZW5kIiwiZXZlbnRzIiwiZXhpc3RpbmciLCJ3YXJuaW5nIiwiVHlwZUVycm9yIiwibmV3TGlzdGVuZXIiLCJlbWl0IiwidW5zaGlmdCIsInB1c2giLCJsZW5ndGgiLCJ3YXJuZWQiLCJ3IiwiRXJyb3IiLCJTdHJpbmciLCJlbWl0dGVyIiwiY291bnQiLCJjb25zb2xlIiwid2FybiIsIl9vbmNlV3JhcCIsInN0YXRlIiwiZmlyZWQiLCJ3cmFwRm4iLCJ3cmFwcGVkIiwiYXJndW1lbnRzIiwicmVtb3ZlTGlzdGVuZXIiLCJfbGlzdGVuZXJzIiwidW53cmFwIiwiZXZsaXN0ZW5lciIsImFyciIsInJldCIsIkFycmF5IiwidW53cmFwTGlzdGVuZXJzIiwiYXJyYXlDbG9uZSIsImxpc3RlbmVyQ291bnQiLCJjb3B5Iiwic2V0IiwiYXJnIiwiUmFuZ2VFcnJvciIsImdldFByb3RvdHlwZU9mIiwic2V0TWF4TGlzdGVuZXJzIiwiZ2V0TWF4TGlzdGVuZXJzIiwiZG9FcnJvciIsImVycm9yIiwiZXIiLCJlcnIiLCJtZXNzYWdlIiwiY29udGV4dCIsImhhbmRsZXIiLCJsZW4iLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsIm9uIiwicHJlcGVuZExpc3RlbmVyIiwib25jZSIsInByZXBlbmRPbmNlTGlzdGVuZXIiLCJsaXN0IiwicG9zaXRpb24iLCJvcmlnaW5hbExpc3RlbmVyIiwic2hpZnQiLCJpbmRleCIsInBvcCIsInNwbGljZU9uZSIsIm9mZiIsInJlbW92ZUFsbExpc3RlbmVycyIsImtleXMiLCJyYXdMaXN0ZW5lcnMiLCJldmVudE5hbWVzIiwicHJvY2VzcyIsImVudiIsIlBST01JU0VfUVVFVUVfQ09WRVJBR0UiLCJjYWNoZWRTZXRUaW1lb3V0IiwiY2FjaGVkQ2xlYXJUaW1lb3V0IiwiZGVmYXVsdFNldFRpbW91dCIsImRlZmF1bHRDbGVhclRpbWVvdXQiLCJydW5UaW1lb3V0IiwiZnVuIiwic2V0VGltZW91dCIsImUiLCJjbGVhclRpbWVvdXQiLCJjdXJyZW50UXVldWUiLCJxdWV1ZSIsImRyYWluaW5nIiwicXVldWVJbmRleCIsImNsZWFuVXBOZXh0VGljayIsImRyYWluUXVldWUiLCJ0aW1lb3V0IiwicnVuIiwibWFya2VyIiwicnVuQ2xlYXJUaW1lb3V0IiwiSXRlbSIsImFycmF5Iiwibm9vcCIsIm5leHRUaWNrIiwidGl0bGUiLCJicm93c2VyIiwiYXJndiIsInZlcnNpb24iLCJ2ZXJzaW9ucyIsImJpbmRpbmciLCJjd2QiLCJjaGRpciIsImRpciIsInVtYXNrIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18iLCJyb290IiwiZmFjdG9yeSIsIkxvY2FsUHJvbWlzZSIsIlByb21pc2UiLCJ0aGVuIiwiUXVldWUiLCJtYXhQZW5kaW5nUHJvbWlzZXMiLCJtYXhRdWV1ZWRQcm9taXNlcyIsIm9wdGlvbnMiLCJwZW5kaW5nUHJvbWlzZXMiLCJJbmZpbml0eSIsImNvbmZpZ3VyZSIsIkdsb2JhbFByb21pc2UiLCJhZGQiLCJwcm9taXNlR2VuZXJhdG9yIiwic2VsZiIsInJlc29sdmUiLCJyZWplY3QiLCJub3RpZnkiLCJfZGVxdWV1ZSIsImdldFBlbmRpbmdMZW5ndGgiLCJnZXRRdWV1ZUxlbmd0aCIsIml0ZW0iLCJvbkVtcHR5IiwiQURERURfTElOS1MiLCJMSVNURU5JTkdfTElOS1MiLCJnZXRMaW5rcyIsImRvY3VtZW50IiwiYm9keSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJtYXAiLCJhIiwiaHJlZiIsImZpbHRlciIsImxpbmsiLCJ0ZXN0IiwibGlua3MiLCJ3cmFwcGVyIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJhbnlBZGRlZCIsIm5ld0xpbmtzIiwiaW5jbHVkZXMiLCJsb2ciLCJnZXRNZXRhRGF0YSIsIm1ldGEiLCJjb250ZW50IiwiZ2V0QXR0cmlidXRlIiwibWF0Y2giLCJyZXBsYWNlIiwiZ2V0TGlua0RhdGEiLCJhc3luYyIsImRpdiIsImlubmVySFRNTCIsImh0bWwiLCJwaG90byIsInVzZXIiLCJpbmZvIiwibWF4Q29uY3VycmVudCIsInByb21wdCIsInByb21pc2VfcXVldWVfZGVmYXVsdCIsImZldGNoSUZyYW1lRGF0YSIsImVsIiwiaWZyYW1lIiwiY29udGVudFdpbmRvdyIsIm9iaiIsInJlbW92ZSIsImdldElGcmFtZURhdGEiLCJzcmMiLCJzdHlsZSIsImRpc3BsYXkiLCJsb2FkIiwicnMiLCJvbmxvYWQiLCJtYWtlSUZyYW1lIiwiZmV0Y2hMaW5rRGF0YSIsImZldGNoIiwidGV4dCIsImFkZDJRdWV1ZSIsInBnIiwicGhvdG9zIiwiYWRkZWRMaW5rcyIsInBob3RvUHJvbWlzZSIsInF1ZXVlTGlua3MiLCJvbmtleWRvd24iLCJmaWxlcyIsImV2dG9iaiIsIndpbmRvdyIsImV2ZW50Iiwia2V5Q29kZSIsImN0cmxLZXkiLCJmaWxlIiwiZXhwb3J0T2JqIiwiZXhwb3J0TmFtZSIsImRhdGFTdHIiLCJlbmNvZGVVUklDb21wb25lbnQiLCJKU09OIiwic3RyaW5naWZ5IiwiZG93bmxvYWRBbmNob3JOb2RlIiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJjbGljayIsImRvd25sb2FkSnNvbiIsInNhdmVMaW5rcyJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLEdBQUEsQ0FDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxRQUFBLElBVUEsT0FOQUksRUFB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V0FBQW9MLEdBQ0FBLElBV3NCQyxDQUFBSCxJQUN0QjVLLEVBQU9SLEtBQU00SCxHQUVibEgsUUFBQXFJLElBQVlyRSxHQUVaaEUsUUFBQXFJLElBQUEsMEJBQ0FqQixTQUFBMEQsVUZqQ09DLElBQUFsSCxJQUNQLE1BQUFtSCxFQUFBQyxPQUFBQyxZQUFBckgsRUFDQSxJQUFBbUgsRUFBQUcsU0FBQUgsRUFBQUksU0FDQUwsRUFBQXhELElBQUEsQ0FBQThELEVBQUFsUSxJR0FPLEVBQUFtUSxFQUFBQyxLQUNQLE1BQUFDLEVBQUEsK0JBQUFDLG1CQUFBQyxLQUFBQyxVQUFBTCxJQUNBTSxFQUFBeEUsU0FBQVcsY0FBQSxLQUVBNkQsRUFBQUMsYUFBQSxPQUFBTCxHQUNBSSxFQUFBQyxhQUFBLFdBQUFOLEVBQUEsU0FFQW5FLFNBQUFDLEtBQUF5RSxZQUFBRixHQUVBQSxFQUFBRyxRQUNBSCxFQUFBaEMsVUhWK0JvQyxDQUFZWCxXQUFnQmxRLE9FOEJ0QzhRLENBQVMsQ0FBQXZCIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNSk7XG4iLCIvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgUiA9IHR5cGVvZiBSZWZsZWN0ID09PSAnb2JqZWN0JyA/IFJlZmxlY3QgOiBudWxsXG52YXIgUmVmbGVjdEFwcGx5ID0gUiAmJiB0eXBlb2YgUi5hcHBseSA9PT0gJ2Z1bmN0aW9uJ1xuICA/IFIuYXBwbHlcbiAgOiBmdW5jdGlvbiBSZWZsZWN0QXBwbHkodGFyZ2V0LCByZWNlaXZlciwgYXJncykge1xuICAgIHJldHVybiBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuY2FsbCh0YXJnZXQsIHJlY2VpdmVyLCBhcmdzKTtcbiAgfVxuXG52YXIgUmVmbGVjdE93bktleXNcbmlmIChSICYmIHR5cGVvZiBSLm93bktleXMgPT09ICdmdW5jdGlvbicpIHtcbiAgUmVmbGVjdE93bktleXMgPSBSLm93bktleXNcbn0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykge1xuICBSZWZsZWN0T3duS2V5cyA9IGZ1bmN0aW9uIFJlZmxlY3RPd25LZXlzKHRhcmdldCkge1xuICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0YXJnZXQpXG4gICAgICAuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModGFyZ2V0KSk7XG4gIH07XG59IGVsc2Uge1xuICBSZWZsZWN0T3duS2V5cyA9IGZ1bmN0aW9uIFJlZmxlY3RPd25LZXlzKHRhcmdldCkge1xuICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0YXJnZXQpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBQcm9jZXNzRW1pdFdhcm5pbmcod2FybmluZykge1xuICBpZiAoY29uc29sZSAmJiBjb25zb2xlLndhcm4pIGNvbnNvbGUud2Fybih3YXJuaW5nKTtcbn1cblxudmFyIE51bWJlcklzTmFOID0gTnVtYmVyLmlzTmFOIHx8IGZ1bmN0aW9uIE51bWJlcklzTmFOKHZhbHVlKSB7XG4gIHJldHVybiB2YWx1ZSAhPT0gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHtcbiAgRXZlbnRFbWl0dGVyLmluaXQuY2FsbCh0aGlzKTtcbn1cbm1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyO1xuXG4vLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjEwLnhcbkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50cyA9IHVuZGVmaW5lZDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50c0NvdW50ID0gMDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDtcblxuLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhbiAxMCBsaXN0ZW5lcnMgYXJlXG4vLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLlxudmFyIGRlZmF1bHRNYXhMaXN0ZW5lcnMgPSAxMDtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KEV2ZW50RW1pdHRlciwgJ2RlZmF1bHRNYXhMaXN0ZW5lcnMnLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGdldDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGRlZmF1bHRNYXhMaXN0ZW5lcnM7XG4gIH0sXG4gIHNldDogZnVuY3Rpb24oYXJnKSB7XG4gICAgaWYgKHR5cGVvZiBhcmcgIT09ICdudW1iZXInIHx8IGFyZyA8IDAgfHwgTnVtYmVySXNOYU4oYXJnKSkge1xuICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSB2YWx1ZSBvZiBcImRlZmF1bHRNYXhMaXN0ZW5lcnNcIiBpcyBvdXQgb2YgcmFuZ2UuIEl0IG11c3QgYmUgYSBub24tbmVnYXRpdmUgbnVtYmVyLiBSZWNlaXZlZCAnICsgYXJnICsgJy4nKTtcbiAgICB9XG4gICAgZGVmYXVsdE1heExpc3RlbmVycyA9IGFyZztcbiAgfVxufSk7XG5cbkV2ZW50RW1pdHRlci5pbml0ID0gZnVuY3Rpb24oKSB7XG5cbiAgaWYgKHRoaXMuX2V2ZW50cyA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICB0aGlzLl9ldmVudHMgPT09IE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKS5fZXZlbnRzKSB7XG4gICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICB0aGlzLl9ldmVudHNDb3VudCA9IDA7XG4gIH1cblxuICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkO1xufTtcblxuLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzXG4vLyB0aGF0IHRvIGJlIGluY3JlYXNlZC4gU2V0IHRvIHplcm8gZm9yIHVubGltaXRlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuc2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24gc2V0TWF4TGlzdGVuZXJzKG4pIHtcbiAgaWYgKHR5cGVvZiBuICE9PSAnbnVtYmVyJyB8fCBuIDwgMCB8fCBOdW1iZXJJc05hTihuKSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdUaGUgdmFsdWUgb2YgXCJuXCIgaXMgb3V0IG9mIHJhbmdlLiBJdCBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4gUmVjZWl2ZWQgJyArIG4gKyAnLicpO1xuICB9XG4gIHRoaXMuX21heExpc3RlbmVycyA9IG47XG4gIHJldHVybiB0aGlzO1xufTtcblxuZnVuY3Rpb24gJGdldE1heExpc3RlbmVycyh0aGF0KSB7XG4gIGlmICh0aGF0Ll9tYXhMaXN0ZW5lcnMgPT09IHVuZGVmaW5lZClcbiAgICByZXR1cm4gRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnM7XG4gIHJldHVybiB0aGF0Ll9tYXhMaXN0ZW5lcnM7XG59XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZ2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24gZ2V0TWF4TGlzdGVuZXJzKCkge1xuICByZXR1cm4gJGdldE1heExpc3RlbmVycyh0aGlzKTtcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIGVtaXQodHlwZSkge1xuICB2YXIgYXJncyA9IFtdO1xuICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7XG4gIHZhciBkb0Vycm9yID0gKHR5cGUgPT09ICdlcnJvcicpO1xuXG4gIHZhciBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gIGlmIChldmVudHMgIT09IHVuZGVmaW5lZClcbiAgICBkb0Vycm9yID0gKGRvRXJyb3IgJiYgZXZlbnRzLmVycm9yID09PSB1bmRlZmluZWQpO1xuICBlbHNlIGlmICghZG9FcnJvcilcbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgLy8gSWYgdGhlcmUgaXMgbm8gJ2Vycm9yJyBldmVudCBsaXN0ZW5lciB0aGVuIHRocm93LlxuICBpZiAoZG9FcnJvcikge1xuICAgIHZhciBlcjtcbiAgICBpZiAoYXJncy5sZW5ndGggPiAwKVxuICAgICAgZXIgPSBhcmdzWzBdO1xuICAgIGlmIChlciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAvLyBOb3RlOiBUaGUgY29tbWVudHMgb24gdGhlIGB0aHJvd2AgbGluZXMgYXJlIGludGVudGlvbmFsLCB0aGV5IHNob3dcbiAgICAgIC8vIHVwIGluIE5vZGUncyBvdXRwdXQgaWYgdGhpcyByZXN1bHRzIGluIGFuIHVuaGFuZGxlZCBleGNlcHRpb24uXG4gICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICB9XG4gICAgLy8gQXQgbGVhc3QgZ2l2ZSBzb21lIGtpbmQgb2YgY29udGV4dCB0byB0aGUgdXNlclxuICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuaGFuZGxlZCBlcnJvci4nICsgKGVyID8gJyAoJyArIGVyLm1lc3NhZ2UgKyAnKScgOiAnJykpO1xuICAgIGVyci5jb250ZXh0ID0gZXI7XG4gICAgdGhyb3cgZXJyOyAvLyBVbmhhbmRsZWQgJ2Vycm9yJyBldmVudFxuICB9XG5cbiAgdmFyIGhhbmRsZXIgPSBldmVudHNbdHlwZV07XG5cbiAgaWYgKGhhbmRsZXIgPT09IHVuZGVmaW5lZClcbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgUmVmbGVjdEFwcGx5KGhhbmRsZXIsIHRoaXMsIGFyZ3MpO1xuICB9IGVsc2Uge1xuICAgIHZhciBsZW4gPSBoYW5kbGVyLmxlbmd0aDtcbiAgICB2YXIgbGlzdGVuZXJzID0gYXJyYXlDbG9uZShoYW5kbGVyLCBsZW4pO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpXG4gICAgICBSZWZsZWN0QXBwbHkobGlzdGVuZXJzW2ldLCB0aGlzLCBhcmdzKTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufTtcblxuZnVuY3Rpb24gX2FkZExpc3RlbmVyKHRhcmdldCwgdHlwZSwgbGlzdGVuZXIsIHByZXBlbmQpIHtcbiAgdmFyIG07XG4gIHZhciBldmVudHM7XG4gIHZhciBleGlzdGluZztcblxuICBpZiAodHlwZW9mIGxpc3RlbmVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIFwibGlzdGVuZXJcIiBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGUgRnVuY3Rpb24uIFJlY2VpdmVkIHR5cGUgJyArIHR5cGVvZiBsaXN0ZW5lcik7XG4gIH1cblxuICBldmVudHMgPSB0YXJnZXQuX2V2ZW50cztcbiAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZXZlbnRzID0gdGFyZ2V0Ll9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIHRhcmdldC5fZXZlbnRzQ291bnQgPSAwO1xuICB9IGVsc2Uge1xuICAgIC8vIFRvIGF2b2lkIHJlY3Vyc2lvbiBpbiB0aGUgY2FzZSB0aGF0IHR5cGUgPT09IFwibmV3TGlzdGVuZXJcIiEgQmVmb3JlXG4gICAgLy8gYWRkaW5nIGl0IHRvIHRoZSBsaXN0ZW5lcnMsIGZpcnN0IGVtaXQgXCJuZXdMaXN0ZW5lclwiLlxuICAgIGlmIChldmVudHMubmV3TGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGFyZ2V0LmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSxcbiAgICAgICAgICAgICAgICAgIGxpc3RlbmVyLmxpc3RlbmVyID8gbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7XG5cbiAgICAgIC8vIFJlLWFzc2lnbiBgZXZlbnRzYCBiZWNhdXNlIGEgbmV3TGlzdGVuZXIgaGFuZGxlciBjb3VsZCBoYXZlIGNhdXNlZCB0aGVcbiAgICAgIC8vIHRoaXMuX2V2ZW50cyB0byBiZSBhc3NpZ25lZCB0byBhIG5ldyBvYmplY3RcbiAgICAgIGV2ZW50cyA9IHRhcmdldC5fZXZlbnRzO1xuICAgIH1cbiAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXTtcbiAgfVxuXG4gIGlmIChleGlzdGluZyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuXG4gICAgZXhpc3RpbmcgPSBldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjtcbiAgICArK3RhcmdldC5fZXZlbnRzQ291bnQ7XG4gIH0gZWxzZSB7XG4gICAgaWYgKHR5cGVvZiBleGlzdGluZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gQWRkaW5nIHRoZSBzZWNvbmQgZWxlbWVudCwgbmVlZCB0byBjaGFuZ2UgdG8gYXJyYXkuXG4gICAgICBleGlzdGluZyA9IGV2ZW50c1t0eXBlXSA9XG4gICAgICAgIHByZXBlbmQgPyBbbGlzdGVuZXIsIGV4aXN0aW5nXSA6IFtleGlzdGluZywgbGlzdGVuZXJdO1xuICAgICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLlxuICAgIH0gZWxzZSBpZiAocHJlcGVuZCkge1xuICAgICAgZXhpc3RpbmcudW5zaGlmdChsaXN0ZW5lcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4aXN0aW5nLnB1c2gobGlzdGVuZXIpO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBsaXN0ZW5lciBsZWFrXG4gICAgbSA9ICRnZXRNYXhMaXN0ZW5lcnModGFyZ2V0KTtcbiAgICBpZiAobSA+IDAgJiYgZXhpc3RpbmcubGVuZ3RoID4gbSAmJiAhZXhpc3Rpbmcud2FybmVkKSB7XG4gICAgICBleGlzdGluZy53YXJuZWQgPSB0cnVlO1xuICAgICAgLy8gTm8gZXJyb3IgY29kZSBmb3IgdGhpcyBzaW5jZSBpdCBpcyBhIFdhcm5pbmdcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuICAgICAgdmFyIHcgPSBuZXcgRXJyb3IoJ1Bvc3NpYmxlIEV2ZW50RW1pdHRlciBtZW1vcnkgbGVhayBkZXRlY3RlZC4gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nLmxlbmd0aCArICcgJyArIFN0cmluZyh0eXBlKSArICcgbGlzdGVuZXJzICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnYWRkZWQuIFVzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnaW5jcmVhc2UgbGltaXQnKTtcbiAgICAgIHcubmFtZSA9ICdNYXhMaXN0ZW5lcnNFeGNlZWRlZFdhcm5pbmcnO1xuICAgICAgdy5lbWl0dGVyID0gdGFyZ2V0O1xuICAgICAgdy50eXBlID0gdHlwZTtcbiAgICAgIHcuY291bnQgPSBleGlzdGluZy5sZW5ndGg7XG4gICAgICBQcm9jZXNzRW1pdFdhcm5pbmcodyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uIGFkZExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gIHJldHVybiBfYWRkTGlzdGVuZXIodGhpcywgdHlwZSwgbGlzdGVuZXIsIGZhbHNlKTtcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyO1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnByZXBlbmRMaXN0ZW5lciA9XG4gICAgZnVuY3Rpb24gcHJlcGVuZExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICByZXR1cm4gX2FkZExpc3RlbmVyKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCB0cnVlKTtcbiAgICB9O1xuXG5mdW5jdGlvbiBvbmNlV3JhcHBlcigpIHtcbiAgdmFyIGFyZ3MgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIGFyZ3MucHVzaChhcmd1bWVudHNbaV0pO1xuICBpZiAoIXRoaXMuZmlyZWQpIHtcbiAgICB0aGlzLnRhcmdldC5yZW1vdmVMaXN0ZW5lcih0aGlzLnR5cGUsIHRoaXMud3JhcEZuKTtcbiAgICB0aGlzLmZpcmVkID0gdHJ1ZTtcbiAgICBSZWZsZWN0QXBwbHkodGhpcy5saXN0ZW5lciwgdGhpcy50YXJnZXQsIGFyZ3MpO1xuICB9XG59XG5cbmZ1bmN0aW9uIF9vbmNlV3JhcCh0YXJnZXQsIHR5cGUsIGxpc3RlbmVyKSB7XG4gIHZhciBzdGF0ZSA9IHsgZmlyZWQ6IGZhbHNlLCB3cmFwRm46IHVuZGVmaW5lZCwgdGFyZ2V0OiB0YXJnZXQsIHR5cGU6IHR5cGUsIGxpc3RlbmVyOiBsaXN0ZW5lciB9O1xuICB2YXIgd3JhcHBlZCA9IG9uY2VXcmFwcGVyLmJpbmQoc3RhdGUpO1xuICB3cmFwcGVkLmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gIHN0YXRlLndyYXBGbiA9IHdyYXBwZWQ7XG4gIHJldHVybiB3cmFwcGVkO1xufVxuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiBvbmNlKHR5cGUsIGxpc3RlbmVyKSB7XG4gIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJsaXN0ZW5lclwiIGFyZ3VtZW50IG11c3QgYmUgb2YgdHlwZSBGdW5jdGlvbi4gUmVjZWl2ZWQgdHlwZSAnICsgdHlwZW9mIGxpc3RlbmVyKTtcbiAgfVxuICB0aGlzLm9uKHR5cGUsIF9vbmNlV3JhcCh0aGlzLCB0eXBlLCBsaXN0ZW5lcikpO1xuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucHJlcGVuZE9uY2VMaXN0ZW5lciA9XG4gICAgZnVuY3Rpb24gcHJlcGVuZE9uY2VMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikge1xuICAgICAgaWYgKHR5cGVvZiBsaXN0ZW5lciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJsaXN0ZW5lclwiIGFyZ3VtZW50IG11c3QgYmUgb2YgdHlwZSBGdW5jdGlvbi4gUmVjZWl2ZWQgdHlwZSAnICsgdHlwZW9mIGxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICAgIHRoaXMucHJlcGVuZExpc3RlbmVyKHR5cGUsIF9vbmNlV3JhcCh0aGlzLCB0eXBlLCBsaXN0ZW5lcikpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuLy8gRW1pdHMgYSAncmVtb3ZlTGlzdGVuZXInIGV2ZW50IGlmIGFuZCBvbmx5IGlmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPVxuICAgIGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICB2YXIgbGlzdCwgZXZlbnRzLCBwb3NpdGlvbiwgaSwgb3JpZ2luYWxMaXN0ZW5lcjtcblxuICAgICAgaWYgKHR5cGVvZiBsaXN0ZW5lciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgXCJsaXN0ZW5lclwiIGFyZ3VtZW50IG11c3QgYmUgb2YgdHlwZSBGdW5jdGlvbi4gUmVjZWl2ZWQgdHlwZSAnICsgdHlwZW9mIGxpc3RlbmVyKTtcbiAgICAgIH1cblxuICAgICAgZXZlbnRzID0gdGhpcy5fZXZlbnRzO1xuICAgICAgaWYgKGV2ZW50cyA9PT0gdW5kZWZpbmVkKVxuICAgICAgICByZXR1cm4gdGhpcztcblxuICAgICAgbGlzdCA9IGV2ZW50c1t0eXBlXTtcbiAgICAgIGlmIChsaXN0ID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHwgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKC0tdGhpcy5fZXZlbnRzQ291bnQgPT09IDApXG4gICAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZGVsZXRlIGV2ZW50c1t0eXBlXTtcbiAgICAgICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyKVxuICAgICAgICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3QubGlzdGVuZXIgfHwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBsaXN0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHBvc2l0aW9uID0gLTE7XG5cbiAgICAgICAgZm9yIChpID0gbGlzdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgIGlmIChsaXN0W2ldID09PSBsaXN0ZW5lciB8fCBsaXN0W2ldLmxpc3RlbmVyID09PSBsaXN0ZW5lcikge1xuICAgICAgICAgICAgb3JpZ2luYWxMaXN0ZW5lciA9IGxpc3RbaV0ubGlzdGVuZXI7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocG9zaXRpb24gPCAwKVxuICAgICAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gMClcbiAgICAgICAgICBsaXN0LnNoaWZ0KCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHNwbGljZU9uZShsaXN0LCBwb3NpdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobGlzdC5sZW5ndGggPT09IDEpXG4gICAgICAgICAgZXZlbnRzW3R5cGVdID0gbGlzdFswXTtcblxuICAgICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIG9yaWdpbmFsTGlzdGVuZXIgfHwgbGlzdGVuZXIpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9mZiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXI7XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID1cbiAgICBmdW5jdGlvbiByZW1vdmVBbGxMaXN0ZW5lcnModHlwZSkge1xuICAgICAgdmFyIGxpc3RlbmVycywgZXZlbnRzLCBpO1xuXG4gICAgICBldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0XG4gICAgICBpZiAoZXZlbnRzLnJlbW92ZUxpc3RlbmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICB0aGlzLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICAgIHRoaXMuX2V2ZW50c0NvdW50ID0gMDtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudHNbdHlwZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGlmICgtLXRoaXMuX2V2ZW50c0NvdW50ID09PSAwKVxuICAgICAgICAgICAgdGhpcy5fZXZlbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgICBkZWxldGUgZXZlbnRzW3R5cGVdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICAvLyBlbWl0IHJlbW92ZUxpc3RlbmVyIGZvciBhbGwgbGlzdGVuZXJzIG9uIGFsbCBldmVudHNcbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZXZlbnRzKTtcbiAgICAgICAgdmFyIGtleTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICBrZXkgPSBrZXlzW2ldO1xuICAgICAgICAgIGlmIChrZXkgPT09ICdyZW1vdmVMaXN0ZW5lcicpIGNvbnRpbnVlO1xuICAgICAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3JlbW92ZUxpc3RlbmVyJyk7XG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHRoaXMuX2V2ZW50c0NvdW50ID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGxpc3RlbmVycyA9IGV2ZW50c1t0eXBlXTtcblxuICAgICAgaWYgKHR5cGVvZiBsaXN0ZW5lcnMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpO1xuICAgICAgfSBlbHNlIGlmIChsaXN0ZW5lcnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBMSUZPIG9yZGVyXG4gICAgICAgIGZvciAoaSA9IGxpc3RlbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG5mdW5jdGlvbiBfbGlzdGVuZXJzKHRhcmdldCwgdHlwZSwgdW53cmFwKSB7XG4gIHZhciBldmVudHMgPSB0YXJnZXQuX2V2ZW50cztcblxuICBpZiAoZXZlbnRzID09PSB1bmRlZmluZWQpXG4gICAgcmV0dXJuIFtdO1xuXG4gIHZhciBldmxpc3RlbmVyID0gZXZlbnRzW3R5cGVdO1xuICBpZiAoZXZsaXN0ZW5lciA9PT0gdW5kZWZpbmVkKVxuICAgIHJldHVybiBbXTtcblxuICBpZiAodHlwZW9mIGV2bGlzdGVuZXIgPT09ICdmdW5jdGlvbicpXG4gICAgcmV0dXJuIHVud3JhcCA/IFtldmxpc3RlbmVyLmxpc3RlbmVyIHx8IGV2bGlzdGVuZXJdIDogW2V2bGlzdGVuZXJdO1xuXG4gIHJldHVybiB1bndyYXAgP1xuICAgIHVud3JhcExpc3RlbmVycyhldmxpc3RlbmVyKSA6IGFycmF5Q2xvbmUoZXZsaXN0ZW5lciwgZXZsaXN0ZW5lci5sZW5ndGgpO1xufVxuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIGxpc3RlbmVycyh0eXBlKSB7XG4gIHJldHVybiBfbGlzdGVuZXJzKHRoaXMsIHR5cGUsIHRydWUpO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yYXdMaXN0ZW5lcnMgPSBmdW5jdGlvbiByYXdMaXN0ZW5lcnModHlwZSkge1xuICByZXR1cm4gX2xpc3RlbmVycyh0aGlzLCB0eXBlLCBmYWxzZSk7XG59O1xuXG5FdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUpIHtcbiAgaWYgKHR5cGVvZiBlbWl0dGVyLmxpc3RlbmVyQ291bnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBsaXN0ZW5lckNvdW50LmNhbGwoZW1pdHRlciwgdHlwZSk7XG4gIH1cbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJDb3VudCA9IGxpc3RlbmVyQ291bnQ7XG5mdW5jdGlvbiBsaXN0ZW5lckNvdW50KHR5cGUpIHtcbiAgdmFyIGV2ZW50cyA9IHRoaXMuX2V2ZW50cztcblxuICBpZiAoZXZlbnRzICE9PSB1bmRlZmluZWQpIHtcbiAgICB2YXIgZXZsaXN0ZW5lciA9IGV2ZW50c1t0eXBlXTtcblxuICAgIGlmICh0eXBlb2YgZXZsaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIGlmIChldmxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gMDtcbn1cblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5ldmVudE5hbWVzID0gZnVuY3Rpb24gZXZlbnROYW1lcygpIHtcbiAgcmV0dXJuIHRoaXMuX2V2ZW50c0NvdW50ID4gMCA/IFJlZmxlY3RPd25LZXlzKHRoaXMuX2V2ZW50cykgOiBbXTtcbn07XG5cbmZ1bmN0aW9uIGFycmF5Q2xvbmUoYXJyLCBuKSB7XG4gIHZhciBjb3B5ID0gbmV3IEFycmF5KG4pO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG47ICsraSlcbiAgICBjb3B5W2ldID0gYXJyW2ldO1xuICByZXR1cm4gY29weTtcbn1cblxuZnVuY3Rpb24gc3BsaWNlT25lKGxpc3QsIGluZGV4KSB7XG4gIGZvciAoOyBpbmRleCArIDEgPCBsaXN0Lmxlbmd0aDsgaW5kZXgrKylcbiAgICBsaXN0W2luZGV4XSA9IGxpc3RbaW5kZXggKyAxXTtcbiAgbGlzdC5wb3AoKTtcbn1cblxuZnVuY3Rpb24gdW53cmFwTGlzdGVuZXJzKGFycikge1xuICB2YXIgcmV0ID0gbmV3IEFycmF5KGFyci5sZW5ndGgpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHJldC5sZW5ndGg7ICsraSkge1xuICAgIHJldFtpXSA9IGFycltpXS5saXN0ZW5lciB8fCBhcnJbaV07XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gcHJvY2Vzcy5lbnYuUFJPTUlTRV9RVUVVRV9DT1ZFUkFHRSA/XG4gICAgcmVxdWlyZSgnLi9saWItY292JykgOlxuICAgIHJlcXVpcmUoJy4vbGliJyk7XG4iLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIiwiLyogZ2xvYmFsIGRlZmluZSwgUHJvbWlzZSAqL1xuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyAmJiB0eXBlb2YgcmVxdWlyZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBDb21tb25KU1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGRlZmluZS5hbWQgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICAgICAgZGVmaW5lKGZhY3RvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEJyb3dzZXIgZ2xvYmFsc1xuICAgICAgICByb290LlF1ZXVlID0gZmFjdG9yeSgpO1xuICAgIH1cbn0pXG4odGhpcywgZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgKi9cbiAgICB2YXIgTG9jYWxQcm9taXNlID0gdHlwZW9mIFByb21pc2UgIT09ICd1bmRlZmluZWQnID8gUHJvbWlzZSA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRoZW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1F1ZXVlLmNvbmZpZ3VyZSgpIGJlZm9yZSB1c2UgUXVldWUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIG5vb3AgPSBmdW5jdGlvbiAoKSB7fTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAgICAgKiBAcmV0dXJucyB7TG9jYWxQcm9taXNlfVxuICAgICAqL1xuICAgIHZhciByZXNvbHZlV2l0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBuZXcgTG9jYWxQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEl0IGxpbWl0cyBjb25jdXJyZW50bHkgZXhlY3V0ZWQgcHJvbWlzZXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbbWF4UGVuZGluZ1Byb21pc2VzPUluZmluaXR5XSBtYXggbnVtYmVyIG9mIGNvbmN1cnJlbnRseSBleGVjdXRlZCBwcm9taXNlc1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbbWF4UXVldWVkUHJvbWlzZXM9SW5maW5pdHldICBtYXggbnVtYmVyIG9mIHF1ZXVlZCBwcm9taXNlc1xuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBxdWV1ZSA9IG5ldyBRdWV1ZSgxKTtcbiAgICAgKlxuICAgICAqIHF1ZXVlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICogICAgIC8vIHJlc29sdmUgb2YgdGhpcyBwcm9taXNlIHdpbGwgcmVzdW1lIG5leHQgcmVxdWVzdFxuICAgICAqICAgICByZXR1cm4gZG93bmxvYWRUYXJiYWxsRnJvbUdpdGh1Yih1cmwsIGZpbGUpO1xuICAgICAqIH0pXG4gICAgICogLnRoZW4oZnVuY3Rpb24gKGZpbGUpIHtcbiAgICAgKiAgICAgZG9TdHVmZldpdGgoZmlsZSk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBxdWV1ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAqICAgICByZXR1cm4gZG93bmxvYWRUYXJiYWxsRnJvbUdpdGh1Yih1cmwsIGZpbGUpO1xuICAgICAqIH0pXG4gICAgICogLy8gVGhpcyByZXF1ZXN0IHdpbGwgYmUgcGF1c2VkXG4gICAgICogLnRoZW4oZnVuY3Rpb24gKGZpbGUpIHtcbiAgICAgKiAgICAgZG9TdHVmZldpdGgoZmlsZSk7XG4gICAgICogfSk7XG4gICAgICovXG4gICAgZnVuY3Rpb24gUXVldWUobWF4UGVuZGluZ1Byb21pc2VzLCBtYXhRdWV1ZWRQcm9taXNlcywgb3B0aW9ucykge1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdGhpcy5wZW5kaW5nUHJvbWlzZXMgPSAwO1xuICAgICAgICB0aGlzLm1heFBlbmRpbmdQcm9taXNlcyA9IHR5cGVvZiBtYXhQZW5kaW5nUHJvbWlzZXMgIT09ICd1bmRlZmluZWQnID8gbWF4UGVuZGluZ1Byb21pc2VzIDogSW5maW5pdHk7XG4gICAgICAgIHRoaXMubWF4UXVldWVkUHJvbWlzZXMgPSB0eXBlb2YgbWF4UXVldWVkUHJvbWlzZXMgIT09ICd1bmRlZmluZWQnID8gbWF4UXVldWVkUHJvbWlzZXMgOiBJbmZpbml0eTtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlZmluZXMgcHJvbWlzZSBwcm9taXNlRmFjdG9yeVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IEdsb2JhbFByb21pc2VcbiAgICAgKi9cbiAgICBRdWV1ZS5jb25maWd1cmUgPSBmdW5jdGlvbiAoR2xvYmFsUHJvbWlzZSkge1xuICAgICAgICBMb2NhbFByb21pc2UgPSBHbG9iYWxQcm9taXNlO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcm9taXNlR2VuZXJhdG9yXG4gICAgICogQHJldHVybiB7TG9jYWxQcm9taXNlfVxuICAgICAqL1xuICAgIFF1ZXVlLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAocHJvbWlzZUdlbmVyYXRvcikge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgTG9jYWxQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIG5vdGlmeSkge1xuICAgICAgICAgICAgLy8gRG8gbm90IHF1ZXVlIHRvIG11Y2ggcHJvbWlzZXNcbiAgICAgICAgICAgIGlmIChzZWxmLnF1ZXVlLmxlbmd0aCA+PSBzZWxmLm1heFF1ZXVlZFByb21pc2VzKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignUXVldWUgbGltaXQgcmVhY2hlZCcpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEFkZCB0byBxdWV1ZVxuICAgICAgICAgICAgc2VsZi5xdWV1ZS5wdXNoKHtcbiAgICAgICAgICAgICAgICBwcm9taXNlR2VuZXJhdG9yOiBwcm9taXNlR2VuZXJhdG9yLFxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHJlc29sdmUsXG4gICAgICAgICAgICAgICAgcmVqZWN0OiByZWplY3QsXG4gICAgICAgICAgICAgICAgbm90aWZ5OiBub3RpZnkgfHwgbm9vcFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHNlbGYuX2RlcXVldWUoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE51bWJlciBvZiBzaW11bHRhbmVvdXNseSBydW5uaW5nIHByb21pc2VzICh3aGljaCBhcmUgcmVzb2x2aW5nKVxuICAgICAqXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqL1xuICAgIFF1ZXVlLnByb3RvdHlwZS5nZXRQZW5kaW5nTGVuZ3RoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wZW5kaW5nUHJvbWlzZXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE51bWJlciBvZiBxdWV1ZWQgcHJvbWlzZXMgKHdoaWNoIGFyZSB3YWl0aW5nKVxuICAgICAqXG4gICAgICogQHJldHVybiB7bnVtYmVyfVxuICAgICAqL1xuICAgIFF1ZXVlLnByb3RvdHlwZS5nZXRRdWV1ZUxlbmd0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVldWUubGVuZ3RoO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiBmaXJzdCBpdGVtIHJlbW92ZWQgZnJvbSBxdWV1ZVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgUXVldWUucHJvdG90eXBlLl9kZXF1ZXVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLnBlbmRpbmdQcm9taXNlcyA+PSB0aGlzLm1heFBlbmRpbmdQcm9taXNlcykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIGZyb20gcXVldWVcbiAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLnF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgIGlmICghaXRlbSkge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5vbkVtcHR5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uRW1wdHkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdQcm9taXNlcysrO1xuXG4gICAgICAgICAgICByZXNvbHZlV2l0aChpdGVtLnByb21pc2VHZW5lcmF0b3IoKSlcbiAgICAgICAgICAgIC8vIEZvcndhcmQgYWxsIHN0dWZmXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEl0IGlzIG5vdCBwZW5kaW5nIG5vd1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnBlbmRpbmdQcm9taXNlcy0tO1xuICAgICAgICAgICAgICAgICAgICAvLyBJdCBzaG91bGQgcGFzcyB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5yZXNvbHZlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGVxdWV1ZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSXQgaXMgbm90IHBlbmRpbmcgbm93XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucGVuZGluZ1Byb21pc2VzLS07XG4gICAgICAgICAgICAgICAgICAgIC8vIEl0IHNob3VsZCBub3QgbWFzayBlcnJvcnNcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5yZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGVxdWV1ZSgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEl0IHNob3VsZCBwYXNzIG5vdGlmaWNhdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5ub3RpZnkobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgc2VsZi5wZW5kaW5nUHJvbWlzZXMtLTtcbiAgICAgICAgICAgIGl0ZW0ucmVqZWN0KGVycik7XG4gICAgICAgICAgICBzZWxmLl9kZXF1ZXVlKCk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICByZXR1cm4gUXVldWU7XG59KTtcbiIsImltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ2V2ZW50cydcclxuXHJcbmV4cG9ydCBjb25zdCBlbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcigpXHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IHtcclxuICAgIEFEREVEX0xJTktTID0gJ2FkZGVkX2xpbmtzJyxcclxuICAgIExJU1RFTklOR19MSU5LUyA9ICdsaXN0ZW5pbmdfbGlua3MnXHJcbn0gPSB7fSIsImltcG9ydCB7IGRvd25sb2FkSnNvbiB9IGZyb20gJy4uL2hlbHBlcnMnXHJcbmltcG9ydCB7IEFEREVEX0xJTktTLCBlbWl0dGVyLCBMSVNURU5JTkdfTElOS1MgfSBmcm9tICcuLi9ldmVudHMnXHJcblxyXG5leHBvcnQgY29uc3QgZ2V0TGlua3MgPSAoKSA9PiBbLi4uZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCdbaHJlZl0nKV1cclxuICAgIC5tYXAoYSA9PiBhLmhyZWYpXHJcbiAgICAuZmlsdGVyKGxpbmsgPT4gL2h0dHBzOlxcL1xcL3d3d1xcLmluc3RhZ3JhbVxcLmNvbVxcL3BcXC8vLnRlc3QobGluaykpXHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IHNhdmVMaW5rcyA9IGZpbGVzID0+IGUgPT4ge1xyXG4gICAgY29uc3QgZXZ0b2JqID0gd2luZG93LmV2ZW50ID8gZXZlbnQgOiBlXHJcbiAgICBpZiAoZXZ0b2JqLmtleUNvZGUgPT0gOTAgJiYgZXZ0b2JqLmN0cmxLZXkpIHtcclxuICAgICAgICBmaWxlcy5tYXAoKGZpbGUsIGkpID0+IGRvd25sb2FkSnNvbihmaWxlLCBgbGlua3NfJHtpfWApKVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbGlua3MgPSBnZXRMaW5rcygpXHJcblxyXG5leHBvcnQgY29uc3QgbGlzdGVuTGlua3MgPSAoKSA9PiB7XHJcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTVN1YnRyZWVNb2RpZmllZCcsICgpID0+IHtcclxuXHJcbiAgICAgICAgbGV0IGFueUFkZGVkID0gZmFsc2VcclxuICAgICAgICBsZXQgY291bnQgPSAwXHJcblxyXG4gICAgICAgIGNvbnN0IG5ld0xpbmtzID0gZ2V0TGlua3MoKVxyXG4gICAgICAgICAgICAuZmlsdGVyKGxpbmsgPT4gIWxpbmtzLmluY2x1ZGVzKGxpbmspKVxyXG4gICAgICAgICAgICAubWFwKGxpbmsgPT4ge1xyXG4gICAgICAgICAgICAgICAgY291bnQrK1xyXG4gICAgICAgICAgICAgICAgYW55QWRkZWQgPSB0cnVlXHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpbmtcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgaWYgKG5ld0xpbmtzLmxlbmd0aCA8IDEpIHJldHVyblxyXG5cclxuICAgICAgICBsaW5rcy5wdXNoKC4uLm5ld0xpbmtzKVxyXG4gICAgICAgIGVtaXR0ZXIuZW1pdChBRERFRF9MSU5LUywgbmV3TGlua3MsIGxpbmtzKVxyXG5cclxuICAgICAgICBpZiAoYW55QWRkZWQpXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBhZGRlZCAke2NvdW50fSBsaW5rcywgdG90YWw6YCwgbGlua3MubGVuZ3RoKVxyXG4gICAgfSlcclxufVxyXG5cclxuLy8gZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSAnJ1xyXG5jb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuZG9jdW1lbnQuYm9keS5hcHBlbmQod3JhcHBlcilcclxuXHJcbmVtaXR0ZXIub24oTElTVEVOSU5HX0xJTktTLCAoKSA9PiB7XHJcbiAgICBlbWl0dGVyLmVtaXQoQURERURfTElOS1MsIGxpbmtzLCBsaW5rcylcclxuICAgIGxpc3RlbkxpbmtzKClcclxufSlcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRNZXRhRGF0YSA9IGFyciA9PiBhcnJcclxuICAgIC5tYXAobWV0YSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50IH0gPSBtZXRhXHJcbiAgICAgICAgY29uc3QgbmFtZSA9IG1ldGEuZ2V0QXR0cmlidXRlKCdwcm9wZXJ0eScpXHJcblxyXG4gICAgICAgIHJldHVybiB7IG5hbWUsIGNvbnRlbnQgfVxyXG4gICAgfSlcclxuICAgIC5maWx0ZXIoYSA9PiBhLm5hbWUgJiYgYS5uYW1lLm1hdGNoKC9vZzouKy8pKVxyXG4gICAgLm1hcChtZXRhID0+IHtcclxuICAgICAgICBsZXQgbmFtZSA9IG1ldGEubmFtZS5yZXBsYWNlKCdvZzonLCAnJylcclxuICAgICAgICBjb25zdCBtYXRjaCA9IG1ldGEuY29udGVudC5tYXRjaCgvQChbXlxccyldKykvKVxyXG4gICAgICAgIGlmIChuYW1lID09PSAnZGVzY3JpcHRpb24nKSB7XHJcbiAgICAgICAgICAgIG1ldGEuY29udGVudCA9IG1hdGNoWzFdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobmFtZSA9PT0gJ2ltYWdlJyB8fCBuYW1lID09PSAnZGVzY3JpcHRpb24nKVxyXG4gICAgICAgICAgICByZXR1cm4gbWV0YS5jb250ZW50XHJcbiAgICB9KVxyXG4gICAgLmZpbHRlcihhID0+ICEhYSlcclxuXHJcbmV4cG9ydCBjb25zdCBtYWtlSUZyYW1lID0gc3JjID0+IHtcclxuICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJylcclxuICAgIGVsLnNyYyA9IHNyY1xyXG4gICAgZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJ1xyXG5cclxuICAgIC8qKkB0eXBlIHsgUHJvbWlzZTxIVE1MSUZyYW1lRWxlbWVudD4gfSAqL1xyXG4gICAgY29uc3QgbG9hZCA9IG5ldyBQcm9taXNlKHJzID0+IGVsLm9ubG9hZCA9ICgpID0+IHJzKGVsKSlcclxuICAgIGNvbnN0IGFkZCA9ICgpID0+IHtcclxuICAgICAgICB3cmFwcGVyLmFwcGVuZChlbClcclxuICAgICAgICByZXR1cm4gbG9hZFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IGVsLCBhZGQsIHJlbW92ZTogKCkgPT4gZWwucmVtb3ZlKCkgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0SUZyYW1lRGF0YSA9IGFzeW5jIGlmcmFtZSA9PiB7XHJcbiAgICBjb25zdCBlbCA9IGF3YWl0IGlmcmFtZS5hZGQoKVxyXG5cclxuICAgIGNvbnN0IFtwaG90bywgdXNlcl0gPSBnZXRNZXRhRGF0YShbLi4uZWwuY29udGVudFdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdtZXRhJyldKVxyXG4gICAgY29uc29sZS5pbmZvKGBHb3QgcGhvdG8gZnJvbSBAJHt1c2VyfWApXHJcblxyXG4gICAgY29uc3Qgb2JqID0geyB1c2VyLCBwaG90byB9XHJcbiAgICBpZnJhbWUucmVtb3ZlKClcclxuXHJcbiAgICByZXR1cm4gb2JqXHJcbn1cclxuXHJcblxyXG5leHBvcnQgY29uc3QgZ2V0TGlua0RhdGEgPSBhc3luYyBodG1sID0+IHtcclxuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXHJcbiAgICBkaXYuaW5uZXJIVE1MID0gaHRtbFxyXG5cclxuICAgIGNvbnN0IFtwaG90bywgdXNlcl0gPSBnZXRNZXRhRGF0YShbLi4uZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoJ21ldGEnKV0pXHJcbiAgICBjb25zb2xlLmluZm8oYEdvdCBwaG90byBmcm9tIEAke3VzZXJ9YClcclxuXHJcbiAgICBjb25zdCBvYmogPSB7IHVzZXIsIHBob3RvIH1cclxuXHJcbiAgICByZXR1cm4gb2JqXHJcbn0iLCJpbXBvcnQgUXVldWUgZnJvbSAncHJvbWlzZS1xdWV1ZSdcclxuXHJcbmNvbnN0IG1heENvbmN1cnJlbnQgPSBOdW1iZXIocHJvbXB0KCdDb25jdXJyZW50JykpIHx8IDJcclxuY29uc3QgbWF4UXVldWUgPSBJbmZpbml0eVxyXG5leHBvcnQgY29uc3QgcXVldWUgPSBuZXcgUXVldWUobWF4Q29uY3VycmVudCwgbWF4UXVldWUpIiwiXHJcbmltcG9ydCB7IGdldExpbmtEYXRhLCBzYXZlTGlua3MsIGdldElGcmFtZURhdGEsIG1ha2VJRnJhbWUgfSBmcm9tICcuL0RPTSdcclxuaW1wb3J0IHsgQURERURfTElOS1MsIExJU1RFTklOR19MSU5LUywgZW1pdHRlciB9IGZyb20gJy4uL2V2ZW50cydcclxuaW1wb3J0IHsgcXVldWUgfSBmcm9tICcuL3F1ZXVlJ1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBmZXRjaElGcmFtZURhdGEgPSBsaW5rID0+ICgpID0+IGdldElGcmFtZURhdGEobWFrZUlGcmFtZShsaW5rKSlcclxuZXhwb3J0IGNvbnN0IGZldGNoTGlua0RhdGEgPSBsaW5rID0+ICgpID0+IGZldGNoKGxpbmspXHJcbiAgICAudGhlbihyID0+IHIudGV4dCgpKVxyXG4gICAgLnRoZW4oZ2V0TGlua0RhdGEpXHJcblxyXG5cclxuY29uc3QgYWRkMlF1ZXVlID0gcGcgPT4ge1xyXG4gICAgY29uc3QgcSA9IHF1ZXVlLmFkZChwZylcclxuXHJcbiAgICByZXR1cm4gcVxyXG59XHJcblxyXG4vKipcclxuICogQHBhcmFtIHsgc3RyaW5nW10gfSBhZGRlZExpbmtzIFxyXG4gKi9cclxuY29uc3QgcXVldWVMaW5rcyA9IHBob3RvcyA9PiBhc3luYyAoYWRkZWRMaW5rcykgPT4ge1xyXG4gICAgY29uc3QgcHVzaFBob3RvcyA9IGFzeW5jIHBob3RvUHJvbWlzZSA9PiB7XHJcbiAgICAgICAgcGhvdG9zLnB1c2goYXdhaXQgcGhvdG9Qcm9taXNlKVxyXG4gICAgICAgIHJldHVybiBwaG90b1Byb21pc2VcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYWRkZWRMaW5rc1xyXG4gICAgICAgIC5tYXAoZmV0Y2hMaW5rRGF0YSlcclxuICAgICAgICAubWFwKGFkZDJRdWV1ZSlcclxuICAgICAgICAubWFwKHB1c2hQaG90b3MpXHJcbn1cclxuXHJcblxyXG5jb25zdCBwaG90b3MgPSBbXVxyXG5lbWl0dGVyLm9uKEFEREVEX0xJTktTLCBxdWV1ZUxpbmtzKHBob3RvcykpXHJcbmVtaXR0ZXIuZW1pdChMSVNURU5JTkdfTElOS1MpXHJcblxyXG5jb25zb2xlLmxvZyhxdWV1ZSlcclxuXHJcbmNvbnNvbGUubG9nKCdcXG5DVFJMICsgWiB0byBkb3dubG9hZCcpXHJcbmRvY3VtZW50Lm9ua2V5ZG93biA9IHNhdmVMaW5rcyhbcGhvdG9zXSlcclxuIiwiLyoqIEB0eXBlIHs8VD4oYXJyOiBUW10sIGxlbjogbnVtYmVyKSA9PiBUW11bXX0gKi9cclxuZXhwb3J0IGNvbnN0IGNodW5rQXJyID0gKGFyciwgbGVuKSA9PiB7XHJcbiAgICBjb25zdCBjaHVua3MgPSBbXVxyXG4gICAgY29uc3QgbiA9IGFyci5sZW5ndGhcclxuXHJcbiAgICBsZXQgaSA9IDBcclxuICAgIHdoaWxlIChpIDwgbikgY2h1bmtzLnB1c2goYXJyLnNsaWNlKGksIGkgKz0gbGVuKSlcclxuXHJcbiAgICByZXR1cm4gY2h1bmtzXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBkb3dubG9hZEpzb24gPSAoZXhwb3J0T2JqLCBleHBvcnROYW1lKSA9PiB7XHJcbiAgICBjb25zdCBkYXRhU3RyID0gJ2RhdGE6dGV4dC9qc29uY2hhcnNldD11dGYtOCwnICsgZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGV4cG9ydE9iaikpXHJcbiAgICBjb25zdCBkb3dubG9hZEFuY2hvck5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJylcclxuXHJcbiAgICBkb3dubG9hZEFuY2hvck5vZGUuc2V0QXR0cmlidXRlKCdocmVmJywgZGF0YVN0cilcclxuICAgIGRvd25sb2FkQW5jaG9yTm9kZS5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZXhwb3J0TmFtZSArICcuanNvbicpXHJcblxyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkb3dubG9hZEFuY2hvck5vZGUpXHJcblxyXG4gICAgZG93bmxvYWRBbmNob3JOb2RlLmNsaWNrKClcclxuICAgIGRvd25sb2FkQW5jaG9yTm9kZS5yZW1vdmUoKVxyXG59XHJcblxyXG4vKipcclxuICogQHRlbXBsYXRlIFQsIFNcclxuICogQHBhcmFtIHsgVCB9IG9ialxyXG4gKiBAcGFyYW0geyAoaXRlbToga2V5b2YgVCwgcHJvcGVydHk6IHN0cmluZykgPT4gUyB9IGNiXHJcbiAqIEByZXR1cm5zIHsgU1tdIH1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBtYXBPYmoob2JqLCBjYikge1xyXG4gICAgY29uc3QgYXJyID0gW11cclxuXHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgIGNvbnN0IGl0ZW0gPSBvYmpba2V5XVxyXG5cclxuICAgICAgICBhcnIucHVzaChjYihpdGVtLCBrZXkpKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhcnJcclxufVxyXG5cclxuLyoqXHJcbiAqIEB0ZW1wbGF0ZSBUXHJcbiAqIEBwYXJhbSB7IFQgfSBvYmpcclxuICogQHBhcmFtIHsgKGl0ZW06IGtleW9mIFQsIHByb3BlcnR5OiBzdHJpbmcpID0+IGJvb2xlYW4gfSBjYlxyXG4gKiBAcmV0dXJucyB7IFtrZXlvZiBULCBzdHJpbmddIH1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBtYXBGaW5kT2JqKG9iaiwgY2IpIHtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IG9ialtrZXldXHJcblxyXG4gICAgICAgIGNvbnN0IGJvb2wgPSBjYihpdGVtLCBrZXkpXHJcblxyXG4gICAgICAgIGlmIChib29sKSByZXR1cm4gW2l0ZW0sIGtleV1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVsbFxyXG59XHJcblxyXG4vKipcclxuICogUmFuZG9tbHkgc2h1ZmZsZSBhbiBhcnJheVxyXG4gKiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjQ1MDk3Ni8xMjkzMjU2XHJcbiAqIEBwYXJhbSAge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gc2h1ZmZsZVxyXG4gKiBAcmV0dXJuIHsgQXJyYXkgfSAgICAgIFRoZSBmaXJzdCBpdGVtIGluIHRoZSBzaHVmZmxlZCBhcnJheVxyXG4gKi9cclxuZXhwb3J0IHZhciBzaHVmZmxlID0gZnVuY3Rpb24gKGFycikge1xyXG4gICAgY29uc3QgYXJyYXkgPSBbLi4uYXJyXVxyXG5cclxuICAgIHZhciBjdXJyZW50SW5kZXggPSBhcnJheS5sZW5ndGhcclxuICAgIHZhciB0ZW1wb3JhcnlWYWx1ZSwgcmFuZG9tSW5kZXhcclxuXHJcbiAgICAvLyBXaGlsZSB0aGVyZSByZW1haW4gZWxlbWVudHMgdG8gc2h1ZmZsZS4uLlxyXG4gICAgd2hpbGUgKDAgIT09IGN1cnJlbnRJbmRleCkge1xyXG4gICAgICAgIC8vIFBpY2sgYSByZW1haW5pbmcgZWxlbWVudC4uLlxyXG4gICAgICAgIHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY3VycmVudEluZGV4KVxyXG4gICAgICAgIGN1cnJlbnRJbmRleCAtPSAxXHJcblxyXG4gICAgICAgIC8vIEFuZCBzd2FwIGl0IHdpdGggdGhlIGN1cnJlbnQgZWxlbWVudC5cclxuICAgICAgICB0ZW1wb3JhcnlWYWx1ZSA9IGFycmF5W2N1cnJlbnRJbmRleF1cclxuICAgICAgICBhcnJheVtjdXJyZW50SW5kZXhdID0gYXJyYXlbcmFuZG9tSW5kZXhdXHJcbiAgICAgICAgYXJyYXlbcmFuZG9tSW5kZXhdID0gdGVtcG9yYXJ5VmFsdWVcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYXJyYXlcclxuXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0geyBudW1iZXIgfSB3IFxyXG4gKiBAcGFyYW0geyBudW1iZXIgfSBoIFxyXG4gKiBAcmV0dXJucyB7IG51bWJlcltdIH0gW3dpZHRoLCBoZWlnaHQsIHRvdGFsXVxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHJlc29sdXRpb24yUmF0aW8gPSAodywgaCkgPT4ge1xyXG4gICAgY29uc3QgZ2NkID0gKHcsIGgpID0+IChoID09IDApID8gdyA6IGdjZChoLCB3ICUgaClcclxuICAgIGNvbnN0IHIgPSBnY2QodywgaClcclxuXHJcbiAgICByZXR1cm4gW3cgLyByLCBoIC8gciwgcl1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHNvcnRBc2MgPSAoYSwgYikgPT4ge1xyXG4gICAgaWYgKGEgPiBiKSB7XHJcbiAgICAgICAgcmV0dXJuIDFcclxuICAgIH1cclxuICAgIGlmIChhIDwgYikge1xyXG4gICAgICAgIHJldHVybiAtMVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIDBcclxufVxyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7IEhUTUxFbGVtZW50IH0gZWxcclxuICogQHBhcmFtIHsgc3RyaW5nIH0gY2xhc3NOYW1lXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgdG9nZ2xlQ2xhc3NOYW1lID0gKGVsLCBjbGFzc05hbWUpID0+IHtcclxuICAgIGNvbnN0IGhhc0NsYXNzID0gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSlcclxuXHJcbiAgICBoYXNDbGFzc1xyXG4gICAgICAgID8gZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpXHJcbiAgICAgICAgOiBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSlcclxuXHJcbiAgICByZXR1cm4gaGFzQ2xhc3NcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHRvZ2dsZUhpZGUgPSBlbCA9PiB0b2dnbGVDbGFzc05hbWUoZWwsICdoaWRkZW4nKSAiXSwic291cmNlUm9vdCI6IiJ9